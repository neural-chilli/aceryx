<!-- web/templates/pages/flows/design.html -->
{% extends "layouts/base.html" %}

{% block header %}
<div class="row g-2 align-items-center">
    <div class="col">
        <h2 class="page-title">{{ flow.name }}</h2>
        <div class="text-muted mt-1">Flow Designer</div>
    </div>
    <div class="col-auto ms-auto d-print-none">
        <div class="btn-list">
            <button class="btn btn-success" id="save-flow">
                <svg class="icon"><use xlink:href="#tabler-device-floppy"></use></svg>
                Save
            </button>
            <button class="btn btn-primary" id="execute-flow">
                <svg class="icon"><use xlink:href="#tabler-player-play"></use></svg>
                Execute
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="row" style="height: calc(100vh - 200px);">
    <!-- Tool palette -->
    <div class="col-md-3">
        <div class="card h-100">
            <div class="card-header">
                <h3 class="card-title">Tools</h3>
            </div>
            <div class="card-body" id="tool-palette">
                <!-- Tool palette loads here -->
            </div>
        </div>
    </div>

    <!-- Flow designer -->
    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-body p-0">
                <div id="flow-designer"
                     data-flow-id="{{ flow.id }}"
                     style="width: 100%; height: 100%;">
                    <!-- ReactFlow mounts here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Properties panel -->
    <div class="col-md-3">
        <div class="card h-100">
            <div class="card-header">
                <h3 class="card-title">Properties</h3>
            </div>
            <div class="card-body" id="properties-panel">
                <div class="text-muted">Select a node to edit properties</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script type="module" src="{{ asset_url('js/flow-designer.js') }}"></script>
{% endblock %}